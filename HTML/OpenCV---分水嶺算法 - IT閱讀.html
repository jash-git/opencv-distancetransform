<!DOCTYPE html>
<!-- saved from url=(0048)https://www.itread01.com/content/1531123099.html -->
<html class="js" lang="zh-TW" prefix="og: http://ogp.me/ns#"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="profile" href="https://gmpg.org/xfn/11">
    <title>OpenCV---分水嶺算法 - IT閱讀</title>
<script src="./OpenCV---分水嶺算法 - IT閱讀_files/pubads_impl_rendering_287.js.下載"></script><script src="./OpenCV---分水嶺算法 - IT閱讀_files/osd.js.下載"></script><script src="./OpenCV---分水嶺算法 - IT閱讀_files/ca-pub-0154844852420477.js.下載"></script><script src="./OpenCV---分水嶺算法 - IT閱讀_files/ca-pub-0154844852420477.js.下載"></script><script>document.documentElement.className = document.documentElement.className.replace("no-js","js");</script>
<link href="./OpenCV---分水嶺算法 - IT閱讀_files/atom-one-dark.min.css" rel="stylesheet">
<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
<link rel="stylesheet" id="hueman-main-style-css" href="./OpenCV---分水嶺算法 - IT閱讀_files/main.info.css" type="text/css" media="all">
<link href="./OpenCV---分水嶺算法 - IT閱讀_files/prettify.css" type="text/css" rel="stylesheet">
<link rel="stylesheet" type="text/css" href="./OpenCV---分水嶺算法 - IT閱讀_files/prettify(1).css">
<style id="hueman-main-style-inline-css" type="text/css">
body { font-family:'Source Sans Pro', Arial, sans-serif;font-size:1.00rem }@media only screen and (min-width: 720px) {
        .nav > li { font-size:1.00rem; }
      }::selection { background-color: #fca61b; }
::-moz-selection { background-color: #fca61b; }a,.themeform label .required,#flexslider-featured .flex-direction-nav .flex-next:hover,#flexslider-featured .flex-direction-nav .flex-prev:hover,.post-hover:hover .post-title a,.post-title a:hover,.sidebar.s1 .post-nav li a:hover i,.content .post-nav li a:hover i,.post-related a:hover,.sidebar.s1 .widget_rss ul li a,#footer .widget_rss ul li a,.sidebar.s1 .widget_calendar a,#footer .widget_calendar a,.sidebar.s1 .alx-tab .tab-item-category a,.sidebar.s1 .alx-posts .post-item-category a,.sidebar.s1 .alx-tab li:hover .tab-item-title a,.sidebar.s1 .alx-tab li:hover .tab-item-comment a,.sidebar.s1 .alx-posts li:hover .post-item-title a,#footer .alx-tab .tab-item-category a,#footer .alx-posts .post-item-category a,#footer .alx-tab li:hover .tab-item-title a,#footer .alx-tab li:hover .tab-item-comment a,#footer .alx-posts li:hover .post-item-title a,.comment-tabs li.active a,.comment-awaiting-moderation,.child-menu a:hover,.child-menu .current_page_item > a,.wp-pagenavi a{ color: #fca61b; }.themeform input[type="submit"],.themeform button[type="submit"],.sidebar.s1 .sidebar-top,.sidebar.s1 .sidebar-toggle,#flexslider-featured .flex-control-nav li a.flex-active,.post-tags a:hover,.sidebar.s1 .widget_calendar caption,#footer .widget_calendar caption,.author-bio .bio-avatar:after,.commentlist li.bypostauthor > .comment-body:after,.commentlist li.comment-author-admin > .comment-body:after{ background-color: #fca61b; }.post-format .format-container { border-color: #fca61b; }.sidebar.s1 .alx-tabs-nav li.active a,#footer .alx-tabs-nav li.active a,.comment-tabs li.active a,.wp-pagenavi a:hover,.wp-pagenavi a:active,.wp-pagenavi span.current{ border-bottom-color: #fca61b!important; }.sidebar.s2 .post-nav li a:hover i,
.sidebar.s2 .widget_rss ul li a,
.sidebar.s2 .widget_calendar a,
.sidebar.s2 .alx-tab .tab-item-category a,
.sidebar.s2 .alx-posts .post-item-category a,
.sidebar.s2 .alx-tab li:hover .tab-item-title a,
.sidebar.s2 .alx-tab li:hover .tab-item-comment a,
.sidebar.s2 .alx-posts li:hover .post-item-title a { color: #3bcfe2; }
.sidebar.s2 .sidebar-top,.sidebar.s2 .sidebar-toggle,.post-comments,.jp-play-bar,.jp-volume-bar-value,.sidebar.s2 .widget_calendar caption{ background-color: #3bcfe2; }.sidebar.s2 .alx-tabs-nav li.active a { border-bottom-color: #3bcfe2; }
.post-comments span:before { border-right-color: #3bcfe2; }
      .search-expand,
              #nav-topbar.nav-container { background-color: #303030}@media only screen and (min-width: 720px) {
                #nav-topbar .nav ul { background-color: #303030; }
              }.is-scrolled #header .nav-container.desktop-sticky,
              .is-scrolled #header .search-expand { background-color: #303030; background-color: rgba(48,48,48,0.90) }.is-scrolled .topbar-transparent #nav-topbar.desktop-sticky .nav ul { background-color: #303030; background-color: rgba(48,48,48,0.95) }#header { background-color: #363944; }
@media only screen and (min-width: 720px) {
  #nav-header .nav ul { background-color: #363944; }
}
        .is-scrolled #header #nav-mobile { background-color: #454e5c; background-color: rgba(69,78,92,0.90) }body { background-color: #eaeaea; }
</style>
 <script async="async" src="./OpenCV---分水嶺算法 - IT閱讀_files/gpt.js.下載"></script>
<script>
  var googletag = googletag || {};
  googletag.cmd = googletag.cmd || [];
</script>

<script>
  googletag.cmd.push(function() {
    googletag.defineSlot('/109765683/728_Banner', [728, 90], 'div-gpt-ad-1533118052929-0').addService(googletag.pubads());
    googletag.pubads().enableSingleRequest();
    googletag.enableServices();
  });
</script>
<script async="async" src="./OpenCV---分水嶺算法 - IT閱讀_files/gpt.js.下載"></script>
<script>
  var googletag = googletag || {};
  googletag.cmd = googletag.cmd || [];
</script>

<script>
  googletag.cmd.push(function() {
    googletag.defineSlot('/109765683/300x250', [[300, 75], [300, 100], [300, 250]], 'div-gpt-ad-1533118295286-0').addService(googletag.pubads());
    googletag.pubads().enableSingleRequest();
    googletag.enableServices();
  });
</script>

<link rel="stylesheet" id="hueman-font-awesome-css" href="./OpenCV---分水嶺算法 - IT閱讀_files/font-awesome.min.css" type="text/css" media="all">
<script type="text/javascript">
/* <![CDATA[ */
var monsterinsights_frontend = {"js_events_tracking":"true","is_debug_mode":"false","download_extensions":"","inbound_paths":"","home_url":"https:\/\/www.itread01.com","track_download_as":"event","internal_label":"int","hash_tracking":"false"};
/* ]]> */
</script>
<script type="text/javascript" src="./OpenCV---分水嶺算法 - IT閱讀_files/frontend.min.js.下載"></script>
<script type="text/javascript" src="./OpenCV---分水嶺算法 - IT閱讀_files/jquery.js.下載"></script>
<script type="text/javascript" src="./OpenCV---分水嶺算法 - IT閱讀_files/jsjquery-migrate.min.js.下載"></script>
<script src="./OpenCV---分水嶺算法 - IT閱讀_files/highlight.js.下載"></script>
<link rel="stylesheet" type="text/css" href="./OpenCV---分水嶺算法 - IT閱讀_files/default.css">
<meta name="generator" content="WordPress 4.8.2">
<!--[if lt IE 9]>
<script src="/img/css/js/html5shiv-printshiv.min.js"></script>
<script src="/img/css/js/selectivizr.js"></script>
<![endif]-->
<style>.ios7.web-app-mode.has-fixed header{ background-color: rgba(45,53,63,.88);}</style><link rel="preload" href="./OpenCV---分水嶺算法 - IT閱讀_files/f(6).txt" as="script"><script type="text/javascript" src="./OpenCV---分水嶺算法 - IT閱讀_files/f(6).txt"></script><link rel="preload" href="./OpenCV---分水嶺算法 - IT閱讀_files/f(7).txt" as="script"><script type="text/javascript" src="./OpenCV---分水嶺算法 - IT閱讀_files/f(7).txt"></script><link rel="preload" href="https://pagead2.googlesyndication.com/pagead/js/r20190109/r20180604/show_ads_impl.js" as="script"><script src="./OpenCV---分水嶺算法 - IT閱讀_files/pubads_impl_287.js.下載" async=""></script><link rel="prefetch" href="https://tpc.googlesyndication.com/safeframe/1-0-31/html/container.html"></head>
<body data-rsssl="1" class="post-template-default single single-post postid-43193 single-format-standard wp-custom-logo col-2cl full-width topbar-enabled header-desktop-sticky header-mobile-sticky chrome hu-smoothscroll">
    <div id="wrapper">
        <header id="header" class="specific-mobile-menu-on one-mobile-menu mobile_menu header-ads-desktop header-ads-mobile topbar-transparent no-header-img fixed-header-on" style="height: 200px; padding-top: 50px;">
        <nav class="nav-container group mobile-menu mobile-sticky " id="nav-mobile" data-menu-id="header-1">
  <div class="mobile-title-logo-in-header"><p class="site-title"><a class="custom-logo-link" href="https://www.itread01.com/" rel="home" title="首頁"><img src="./OpenCV---分水嶺算法 - IT閱讀_files/logo.png"></a></p>
                </div>
        <div class="ham__navbar-toggler-two collapsed" title="Menu" aria-expanded="false">
          <div class="ham__navbar-span-wrapper">
            <span class="line line-1"></span>
            <span class="line line-2"></span>
            <span class="line line-3"></span>
          </div>
        </div>
            
      <div class="nav-text"></div>
      <div class="nav-wrap container">
                  <ul class="nav container-inner group mobile-search">
                            <li>
                  <form class="searchform themeform" onsubmit="return searchKw(this)">
	<div>
		<input type="text" name="kw" class="search" onblur="if(this.value==&#39;&#39;)this.value=&#39;輸入關鍵字後搜尋&#39;;" onfocus="if(this.value==&#39;輸入關鍵字後搜尋&#39;)this.value=&#39;&#39;;" value="輸入關鍵字後搜尋">
	</div>
</form>    
<script>function searchKw(c){var b=c.getElementsByTagName("input")[0],a=b.value.replace(/^\s+|\s+$/g,"");a=a.replace(/['"]/g,"");location.href="https://www.itread01.com/search/"+encodeURIComponent(a)+"";return false};</script>            </li>
                      </ul>
                <ul id="menu-top" class="nav container-inner group">
                 <li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-290"><a href="https://www.itread01.com/">首頁</a></li>
				<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-290"><a href="https://www.itread01.com/%E7%A7%91%E6%8A%80/">科技</a></li>
						  <li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-290"><a href="https://www.itread01.com/info/">程式語言</a></li>
 
</ul>      </div>
</nav><!--/#nav-topbar-->  
        <nav class="nav-container group desktop-menu desktop-sticky sticky-visible" id="nav-topbar" data-menu-id="header-2" style="max-width: 1903px;">
    <div class="nav-text"></div>
  <div class="topbar-toggle-down">
    <i class="fas fa-angle-double-down" aria-hidden="true" data-toggle="down" title="展開功能表清單"></i>
    <i class="fas fa-angle-double-up" aria-hidden="true" data-toggle="up" title="折疊功能表清單"></i>
  </div>
  <div class="nav-wrap container">
    <ul id="menu-footer" class="nav container-inner group"> 
    <li id="menu-item-1907" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-1907"><a href="https://www.itread01.com/" rel="nofollow">首頁</a></li>
<li id="menu-item-1907" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-1907"><a href="https://www.itread01.com/study/mysql-tutorial.html">MySQL教學</a></li>
<li id="menu-item-1907" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-1907"><a href="https://www.itread01.com/t/%E7%B6%B2%E7%AB%99%E6%8A%80%E5%B7%A7/1/">網站技巧</a></li>
<li id="menu-item-1907" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-1907"><a href="https://www.itread01.com/t/%E7%B6%B2%E8%B7%AF%E7%A8%8B%E5%BC%8F%E8%A8%AD%E8%A8%88/1/">網路程式設計</a></li>
<li id="menu-item-1907" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-1907"><a href="https://www.itread01.com/t/%E8%BB%9F%E9%AB%94%E7%A8%8B%E5%BC%8F%E8%A8%AD%E8%A8%88/1/">軟體程式設計</a></li>
<li id="menu-item-1907" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-1907"><a href="https://www.itread01.com/t/%E8%B3%87%E6%96%99%E5%BA%AB/1/">資料庫</a></li>
<li id="menu-item-1907" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-1907"><a href="https://www.itread01.com/t/%E4%BD%9C%E6%A5%AD%E7%B3%BB%E7%B5%B1/1/">作業系統</a></li>
<li id="menu-item-1907" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-1907"><a href="https://www.itread01.com/t/%E6%8C%87%E4%BB%A4%E7%A2%BC%E5%B0%88%E6%AC%84/1/">其它</a></li>
 
</ul>  </div>
      <div id="topbar-header-search" class="container">
      <div class="container-inner">
        <div class="toggle-search"><i class="fas fa-search"></i></div>
        <div class="search-expand">
          <div class="search-expand-inner"><form class="searchform themeform" onsubmit="return searchKw(this)">
	<div>
		<input type="text" class="search" name="kw" onblur="if(this.value==&#39;&#39;)this.value=&#39;輸入關鍵字後搜尋&#39;;" onfocus="if(this.value==&#39;輸入關鍵字後搜尋&#39;)this.value=&#39;&#39;;" value="輸入關鍵字後搜尋">
	</div>
</form></div>
        </div>
      </div><!--/.container-inner-->
    </div><!--/.container-->
  
</nav><!--/#nav-topbar-->  
  <div class="container group">
        <div class="container-inner">

                    <div class="group pad central-header-zone">
                  <div class="logo-tagline-group">
                                        <p class="site-title"><a class="custom-logo-link" href="https://www.itread01.com/" rel="home"><img src="./OpenCV---分水嶺算法 - IT閱讀_files/logo.png"></a></p>
                                                        </div>

                                        <div id="header-widgets">
                          <div id="custom_html-2" class="widget_text widget widget_custom_html"><div class="textwidget custom-html-widget"><!-- /109765683/728_Banner -->
<div id="div-gpt-ad-1533118052929-0" style="height:90px; width:728px;" data-google-query-id="CNy1-M3p7t8CFQ97iwodjGkLPQ">
<script>
googletag.cmd.push(function() { googletag.display('div-gpt-ad-1533118052929-0'); });
</script>
<div id="google_ads_iframe_/109765683/728_Banner_0__container__" style="border: 0pt none; display: inline-block; width: 728px; height: 90px;"><iframe frameborder="0" src="./OpenCV---分水嶺算法 - IT閱讀_files/container.html" id="google_ads_iframe_/109765683/728_Banner_0" title="3rd party ad content" name="" scrolling="no" marginwidth="0" marginheight="0" width="728" height="90" data-is-safeframe="true" sandbox="allow-forms allow-pointer-lock allow-popups allow-popups-to-escape-sandbox allow-same-origin allow-scripts allow-top-navigation-by-user-activation" data-google-container-id="1" style="border: 0px; vertical-align: bottom;" data-load-complete="true"></iframe></div></div></div></div>                      </div><!--/#header-ads-->
                                </div>
                <nav class="nav-container group desktop-menu " id="nav-header" data-menu-id="header-3">
    <div class="nav-text"><!-- put your mobile menu text here --></div>
  <div class="nav-wrap container">
        <ul id="menu-top-1" class="nav container-inner group">
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-290"><a href="https://www.itread01.com/">首頁</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-290"><a href="https://www.itread01.com/%E7%A7%91%E6%8A%80/">科技</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-290"><a href="https://www.itread01.com/info/">程式語言</a></li>
</ul>  </div>
</nav><!--/#nav-header-->      
    </div><!--/.container-inner-->
      </div><!--/.container-->
</header><!--/#header-->        
        <div class="container" id="page">
            <div class="container-inner">

                                <div class="main" style="">
                    <div class="main-inner group">
                        
              <section class="content">
              <div class="page-title pad group">
          	    		<ul class="meta-single group">
    			<li class="category"><a href="https://www.itread01.com/infolist/%E7%B7%A8%E7%A8%8B%E8%AA%9E%E8%A8%80/1/">編程語言</a></li>
    			    		</ul>

    	
    </div><!--/.page-title-->
          <div class="pad group">
              <article class="post-43193 post type-post status-publish format-standard has-post-thumbnail hentry category-news tag-stripe tag-32305 tag-32306 tag-4550 tag-5237 tag-31545 tag-6260">
    <div class="post-inner group">

      <h1 class="post-title entry-title">OpenCV---分水嶺算法</h1>
<p class="post-byline"><span class="vcard author">
     <span class="fn"><a href="https://www.itread01.com/infolist/%E7%B7%A8%E7%A8%8B%E8%AA%9E%E8%A8%80/1/">編程語言</a></span>
   </span> ·
                            發表 <time class="published" datetime="2018-07-09">2018-07-09</time>
             
               </p>
      
      <div class="clear"></div>
  <center><script type="text/javascript" src="./OpenCV---分水嶺算法 - IT閱讀_files/auto.js.下載"></script> <script async="" src="./OpenCV---分水嶺算法 - IT閱讀_files/f(8).txt"></script>
<ins class="adsbygoogle" style="display: block; height: 90px;" data-ad-client="ca-pub-0154844852420477" data-ad-slot="2357692629" data-ad-format="auto" data-adsbygoogle-status="done"><ins id="aswift_1_expand" style="display:inline-table;border:none;height:90px;margin:0;padding:0;position:relative;visibility:visible;width:980px;background-color:transparent;"><ins id="aswift_1_anchor" style="display:block;border:none;height:90px;margin:0;padding:0;position:relative;visibility:visible;width:980px;background-color:transparent;"><iframe width="980" height="90" frameborder="0" marginwidth="0" marginheight="0" vspace="0" hspace="0" allowtransparency="true" scrolling="no" allowfullscreen="true" onload="var i=this.id,s=window.google_iframe_oncopy,H=s&amp;&amp;s.handlers,h=H&amp;&amp;H[i],w=this.contentWindow,d;try{d=w.document}catch(e){}if(h&amp;&amp;d&amp;&amp;(!d.body||!d.body.firstChild)){if(h.call){setTimeout(h,0)}else if(h.match){try{h=s.upd(h,i)}catch(e){}w.location.replace(h)}}" id="aswift_1" name="aswift_1" style="left:0;position:absolute;top:0;border:0px;width:980px;height:90px;" src="./OpenCV---分水嶺算法 - IT閱讀_files/saved_resource(3).html"></iframe></ins></ins></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
</center>
      <div class="entry themeform share">
        <div class="entry-inner">
		解決   再次   .com   -c   查看   通過   浮點型   pri   sub   <p></p><p><img alt="技術分享圖片" src="./OpenCV---分水嶺算法 - IT閱讀_files/20180709135757171104.png"><img alt="技術分享圖片" src="./OpenCV---分水嶺算法 - IT閱讀_files/20180709135757508031.png"><img alt="技術分享圖片" src="./OpenCV---分水嶺算法 - IT閱讀_files/20180709135757773666.png" width="495" height="353"></p>
<h1>推文：</h1>
<h2>OpenCV學習(7) 分水嶺算法(1)（原理簡介簡單明了）</h2>
<h2 class="title">OpenCV-Python教程:31.分水嶺算法對圖像進行分割（步驟講解不錯）</h2>
<h1>使用分水嶺算法進行圖像分割</h1>
<h2>（一）獲取灰度圖像，二值化圖像，進行形態學操作，消除噪點</h2>
<div class="code">
<pre class="hljs python"><span style="color: #000000"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">watershed_demo</span><span class="hljs-params">(image)</span>:</span>
    blur </span>= cv.pyrMeanShiftFiltering(image,<span style="color: #800080"><span class="hljs-number">10</span></span>,<span style="color: #800080"><span class="hljs-number">100</span></span><span style="color: #000000">)
    gray </span>=<span style="color: #000000"> cv.cvtColor(blur,cv.COLOR_BGR2GRAY)　　<span class="hljs-comment">#獲取灰度圖像</span>
    ret,binary </span>= cv.threshold(gray,<span style="color: #800080"><span class="hljs-number">0</span></span>,<span style="color: #800080"><span class="hljs-number">255</span></span>,cv.THRESH_BINARY|<span style="color: #000000">cv.THRESH_OTSU)　　<span class="hljs-comment">#將圖像轉為黑色和白色部分</span>
    cv.imshow(</span><span style="color: #800000"><span class="hljs-string">"</span></span><span style="color: #800000"><span class="hljs-string">binary</span></span><span style="color: #800000"><span class="hljs-string">"</span></span>,binary)　　<span class="hljs-comment">#獲取二值化圖像</span></pre>
</div>
<p><img alt="技術分享圖片" src="./OpenCV---分水嶺算法 - IT閱讀_files/20180709135758102780.png"></p>
<div class="code">
<pre class="hljs nginx"><span style="color: #000000">    <span class="hljs-comment">#形態學操作，進一步消除圖像中噪點</span>
    <span class="hljs-attribute">kernel</span> </span>= cv.getStructuringElement(cv.MORPH_RECT,(<span style="color: #800080"><span class="hljs-number">3</span></span>,<span style="color: #800080"><span class="hljs-number">3</span></span><span style="color: #000000">))
    mb </span>= cv.morphologyEx(binary,cv.MORPH_OPEN,kernel,iterations=<span style="color: #800080"><span class="hljs-number">2</span></span><span style="color: #000000">)  <span class="hljs-comment">#iterations連續兩次開操作，消除圖像的噪點</span><br></span></pre>
</div>
<p><img alt="技術分享圖片" src="./OpenCV---分水嶺算法 - IT閱讀_files/20180709135758548110.png"></p>
<h2>（二）在距離變換前加上一步操作：通過對上面形態學去噪點後的圖像，進行膨脹操作，可以得到大部分都是背景的區域（原黑色不是我們需要的部分是背景）</h2>
<div class="code">
<pre class="hljs nginx">    <span class="hljs-attribute">sure_bg</span> = cv.<span style="color: #ff0000">dilate</span>(mb,kernel,iterations=<span style="color: #800080"><span class="hljs-number">3</span></span>) <span class="hljs-comment">#3次膨脹,可以獲取到大部分都是背景的區域</span></pre>
</div>
<h2><img alt="技術分享圖片" src="./OpenCV---分水嶺算法 - IT閱讀_files/20180709135759099889.png"></h2>
<h2>（三）使用距離變換distanceTransform獲取<span style="color: #ff0000">確定</span>的前景色</h2>
<div class="code">
<pre class="hljs"><strong><span style="color: #ff0000">根據distanceTransform獲取距離背景最小距離的結果（詳細看下面相關知識補充）
根據distanceTransform操作的結果，設置一個閾值，使用threshold決定哪些區域是前景，這樣得到正確結果的概率很高</span></strong></pre>
</div>
<div class="code">
<pre class="hljs nginx">    <span class="hljs-attribute">dist</span> = cv.distanceTransform(mb,cv.DIST_L2,<span style="color: #800080"><span class="hljs-number">5</span></span><span style="color: #000000">)　　<strong><span style="color: #ff0000"><span class="hljs-comment">#獲取距離數據結果</span></span></strong>
    ret, sure_fg </span>= cv.threshold(dist,dist.max()*<span style="color: #800080"><span class="hljs-number">0</span>.<span class="hljs-number">6</span></span>,<span style="color: #800080"><span class="hljs-number">255</span></span>,cv.THRESH_BINARY)　　<strong><span style="color: #ff0000"><span class="hljs-comment">#獲取前景色</span></span></strong></pre>
</div>
<p><img alt="技術分享圖片" src="./OpenCV---分水嶺算法 - IT閱讀_files/20180709135759338179.png"></p>
<hr>
<h1><span style="color: #ff0000; font-size: 1.5em">相關知識補充（重點）</span></h1>
<p><strong><span style="color: #ff0000">（1）距離變換原理</span></strong></p>
<p>推文：圖像識別中距離變換的原理及作用詳解,並附用OpenCV中的distanceTransform實現距離變換的代碼!（距離變換的定義講得不錯）</p>
<div class="code">
<pre class="hljs">距離變換的處理圖像通常都是二值圖像，而二值圖像其實就是把圖像分為兩部分，即背景和物體兩部分，物體通常又稱為前景目標！<br>通常我們把前景目標的灰度值設為255，即白色<br>背景的灰度值設為0，即黑色。<br>所以定義中的非零像素點即為前景目標，零像素點即為背景。<br>所以圖像中前景目標中的<span style="color: #ff0000">像素點距離背景越遠</span>，<span style="color: #ff0000">那麽距離就越大</span>，如果我們<strong><span style="color: #ff0000">用這個距離值替換像素值</span></strong>，那麽<span style="color: #ff0000">新生成的圖像中這個點越亮</span>。</pre>
</div>
<p><img alt="技術分享圖片" src="./OpenCV---分水嶺算法 - IT閱讀_files/20180709135759502248.png"></p>
<div class="code">
<pre class="hljs">再通過設定合理的閾值對距離變換後的圖像進行二值化處理，則可得到去除手指的圖像(如下圖“bidist”窗口圖像所示)，手掌重心即為該圖像的幾何中心。</pre>
</div>
<p><img alt="技術分享圖片" src="./OpenCV---分水嶺算法 - IT閱讀_files/20180709135759832339.png"></p>
<p><strong><span style="color: #ff0000">（2）distanceTransform函數</span></strong></p>
<div class="code">
<pre class="hljs"><span style="color: #ff0000">主要用於計算非零像素到最近零像素點的最短距離。一般用於求解圖像的骨骼</span></pre>
</div>
<div class="code">
<pre class="hljs python"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">distanceTransform</span><span class="hljs-params">(src, distanceType, maskSize, dst=None, dstType=None)</span>:</span> <span class="hljs-comment"># real signature unknown; restored </span><span style="color: #0000ff"><span class="hljs-comment">from</span></span><span class="hljs-comment"> __doc__</span></pre>
</div>
<div class="code">
<pre class="hljs coffeescript"><span style="color: #000000">src：輸入的圖像，一般為二值圖像
distanceType：所用的求解距離的類型，有CV_DIST_L1, CV_DIST_L2 , <span class="hljs-keyword">or</span> CV_DIST_C
mask_size：距離變換掩模的大小，可以是 </span><span style="color: #800080"><span class="hljs-number">3</span></span> 或 <span style="color: #800080"><span class="hljs-number">5</span></span><span class="hljs-number">.</span> 對 CV_DIST_L1 或 CV_DIST_C 的情況，參數值被強制設定為 <span style="color: #800080"><span class="hljs-number">3</span></span>, 因為 <span style="color: #800080"><span class="hljs-number">3</span></span>×<span style="color: #800080"><span class="hljs-number">3</span></span> mask 給出 <span style="color: #800080"><span class="hljs-number">5</span></span>×<span style="color: #800080"><span class="hljs-number">5</span></span> mask 一樣的結果，而且速度還更快。</pre>
</div>
<p><strong>（3）若是想骨骼顯示（對我們的分水嶺流程無影響），我們需要對distanceTransform返回的結果進行歸一化處理，使用normalize</strong></p>
<div class="code">
<pre class="hljs css">因為<span class="hljs-selector-tag">distanceTransform</span>返回的圖像數據是浮點數值，要想在浮點數表示的顏色空間中，數值範圍必須是0<span class="hljs-selector-tag">-</span><span style="color: #800080"><span class="hljs-selector-tag">1</span><span class="hljs-selector-class">.0</span></span>，所以要將其中的數值進行歸一化處理</pre>
</div>
<div class="code">
<pre class="hljs css"><strong><span style="color: #ff0000">（重點）在整數表示的顏色空間中，數值範圍是0<span class="hljs-selector-tag">-255</span>，但在浮點數表示的顏色空間中，數值範圍是0<span class="hljs-selector-tag">-1</span><span class="hljs-selector-class">.0</span>，所以要把0<span class="hljs-selector-tag">-255</span>歸一化。<br>順便補充：若是不做歸一化處理，數值大於1的都會變為1<span class="hljs-selector-class">.0</span>處理</span></strong></pre>
</div>
<div class="code">
<pre class="hljs makefile">mb = cv.morphologyEx(binary,cv.MORPH_OPEN,kernel,iterations=<span style="color: #800080">2</span><span style="color: #000000">)  <span class="hljs-comment">#iterations連續兩次開操作</span>
    cv.imshow(</span><span style="color: #800000"><span class="hljs-string">"</span></span><span style="color: #800000"><span class="hljs-string">mb</span></span><span style="color: #800000"><span class="hljs-string">"</span></span><span style="color: #000000">, mb)　　<strong><span style="color: #ff0000"><span class="hljs-comment">#這是我們形態學開操作過濾噪點後的圖像，暫時可以看做源圖像</span></span></strong>
    <span class="hljs-comment">#距離變換</span>
    dist </span>= cv.<strong><span style="color: #ff0000">distanceTransform</span></strong>(mb,cv.DIST_L2,<span style="color: #800080">5</span><span style="color: #000000">)　　<strong><span style="color: #ff0000"><span class="hljs-comment">#這是我們獲取的字段距離數值，對應每個像素都有，所以數組結構和圖像數組一致</span></span></strong>
    cv.imshow(</span><span style="color: #800000"><span class="hljs-string">"</span></span><span style="color: #800000"><span class="hljs-string">dist</span></span><span style="color: #800000"><span class="hljs-string">"</span></span><span style="color: #000000">,dist)
    dist_output </span>= cv.<strong><span style="color: #ff0000">normalize</span></strong>(dist,<span style="color: #800080">0</span>,<span style="color: #800080">1.0</span><span style="color: #000000">,cv.NORM_MINMAX)　　<strong><span style="color: #ff0000"><span class="hljs-comment">#歸一化的距離圖像數組</span><br></span></strong><span class="hljs-comment">　  cv.imshow("distinct-t",dist_output*50)</span></span></pre>
</div>
<p><strong><span style="color: #ff0000"><img alt="技術分享圖片" src="./OpenCV---分水嶺算法 - IT閱讀_files/20180709135800025705.png"></span></strong></p>
<div class="code">
<pre class="hljs css">發現了似乎<span class="hljs-selector-tag">distanceTransform</span>返回的圖像和源圖像一樣，似乎出錯了<br>原因：因為<span class="hljs-selector-tag">distanceTransform</span>返回的是浮點型色彩空間，而<span class="hljs-selector-tag">dist</span>中存放的數距離0值的最小距離，大多是大於1<span class="hljs-selector-class">.0</span>的數值，<br>而上面提到浮點型色彩空間數值範圍0<span class="hljs-selector-tag">-1</span><span class="hljs-selector-class">.0</span>，當數值大於1<span class="hljs-selector-class">.0</span>都會被設置為1<span class="hljs-selector-class">.0</span>，顯示白色，所以和原來的二值化圖像一致，<br>我們要想顯示骨骼，必須先進行歸一化處理</pre>
</div>
<div class="code">
<pre class="hljs markdown">下面是從二值化圖像源，distanceTransform距離數組，和歸一化距離數組中獲取的一段像素數組<br>    print(mb[<span style="color: #800080"><span class="hljs-string">150</span></span>][<span style="color: #800080"><span class="hljs-symbol">120</span></span><span class="hljs-symbol">:</span><span style="color: #800080"><span class="hljs-symbol">140</span></span><span style="color: #000000">])　　
<span class="hljs-code">    print(dist[</span></span><span style="color: #800080"><span class="hljs-code">150</span></span><span class="hljs-code">][</span><span style="color: #800080"><span class="hljs-code">120</span></span><span class="hljs-code">:</span><span style="color: #800080"><span class="hljs-code">140</span></span><span style="color: #000000"><span class="hljs-code">])</span>
<span class="hljs-code">    print(dist_output[</span></span><span style="color: #800080"><span class="hljs-code">150</span></span><span class="hljs-code">][</span><span style="color: #800080"><span class="hljs-code">120</span></span><span class="hljs-code">:</span><span style="color: #800080"><span class="hljs-code">140</span></span><span class="hljs-code">])</span></pre>
</div>
<div class="code">
<pre class="hljs">整數型色彩空間二值化圖像<br>[  <span style="color: #800080">0</span>   <span style="color: #800080">0</span>   <span style="color: #800080">0</span>   <span style="color: #800080">0</span>   <span style="color: #800080">0</span>   <span style="color: #800080">0</span>   <span style="color: #800080">0</span>   <span style="color: #800080">0</span>   <span style="color: #800080">0</span> <span style="color: #800080">255</span> <span style="color: #800080">255</span> <span style="color: #800080">255</span> <span style="color: #800080">255</span> <span style="color: #800080">255</span> <span style="color: #800080">255</span> <span style="color: #800080">255</span> <span style="color: #800080">255</span> <span style="color: #800080">255</span>
 <span style="color: #800080">255</span> <span style="color: #800080">255</span><span style="color: #000000">]</span></pre>
<hr>
<pre class="hljs cs"><span style="color: #000000">浮點型色彩空間最小距離數組，由於數值大於<span class="hljs-number">1.0</span>都會被設置為<span class="hljs-number">1.0</span>，所以和上面二值化圖像一致
[<span class="hljs-meta"> </span></span><span style="color: #800080"><span class="hljs-meta">0</span></span><span class="hljs-meta">.        </span><span style="color: #800080"><span class="hljs-meta">0</span></span><span class="hljs-meta">.        </span><span style="color: #800080"><span class="hljs-meta">0</span></span><span class="hljs-meta">.        </span><span style="color: #800080"><span class="hljs-meta">0</span></span><span class="hljs-meta">.        </span><span style="color: #800080"><span class="hljs-meta">0</span></span><span class="hljs-meta">.        </span><span style="color: #800080"><span class="hljs-meta">0</span></span><span class="hljs-meta">.        </span><span style="color: #800080"><span class="hljs-meta">0</span></span><span style="color: #000000"><span class="hljs-meta">.
  </span></span><span style="color: #800080"><span class="hljs-meta">0</span></span><span class="hljs-meta">.        </span><span style="color: #800080"><span class="hljs-meta">0</span></span><span class="hljs-meta">.        </span><span style="color: #800080"><span class="hljs-meta">1</span></span><span class="hljs-meta">.        </span><span style="color: #800080"><span class="hljs-meta">1.4</span></span><span class="hljs-meta">       </span><span style="color: #800080"><span class="hljs-meta">2.1969</span></span><span class="hljs-meta">    </span><span style="color: #800080"><span class="hljs-meta">3.1969</span></span><span class="hljs-meta">    </span><span style="color: #800080"><span class="hljs-meta">4.1969</span></span><span class="hljs-meta">
  </span><span style="color: #800080"><span class="hljs-meta">5.1969</span></span><span class="hljs-meta">    </span><span style="color: #800080"><span class="hljs-meta">6.1969</span></span><span class="hljs-meta">    </span><span style="color: #800080"><span class="hljs-meta">7.1969</span></span><span class="hljs-meta">    </span><span style="color: #800080"><span class="hljs-meta">8.196899</span></span><span class="hljs-meta">  </span><span style="color: #800080"><span class="hljs-meta">9.196899</span></span><span class="hljs-meta"> </span><span style="color: #800080"><span class="hljs-meta">10.187599</span></span><span style="color: #000000">]</span></pre>
<hr>
<pre class="hljs cs"><span style="color: #000000">浮點型色彩空間歸一化數組圖像，顯示骨骼
[</span><span style="color: #800080"><span class="hljs-meta">0</span></span><span class="hljs-meta">.         </span><span style="color: #800080"><span class="hljs-meta">0</span></span><span class="hljs-meta">.         </span><span style="color: #800080"><span class="hljs-meta">0</span></span><span class="hljs-meta">.         </span><span style="color: #800080"><span class="hljs-meta">0</span></span><span class="hljs-meta">.         </span><span style="color: #800080"><span class="hljs-meta">0</span></span><span class="hljs-meta">.         </span><span style="color: #800080"><span class="hljs-meta">0</span></span><span style="color: #000000"><span class="hljs-meta">.
 </span></span><span style="color: #800080"><span class="hljs-meta">0</span></span><span class="hljs-meta">.         </span><span style="color: #800080"><span class="hljs-meta">0</span></span><span class="hljs-meta">.         </span><span style="color: #800080"><span class="hljs-meta">0</span></span><span class="hljs-meta">.         </span><span style="color: #800080"><span class="hljs-meta">0.00047065</span></span><span class="hljs-meta"> </span><span style="color: #800080"><span class="hljs-meta">0.0006589</span></span><span class="hljs-meta">  </span><span style="color: #800080"><span class="hljs-meta">0.00103396</span></span><span class="hljs-meta">
 </span><span style="color: #800080"><span class="hljs-meta">0.00150461</span></span><span class="hljs-meta"> </span><span style="color: #800080"><span class="hljs-meta">0.00197525</span></span><span class="hljs-meta"> </span><span style="color: #800080"><span class="hljs-meta">0.00244589</span></span><span class="hljs-meta"> </span><span style="color: #800080"><span class="hljs-meta">0.00291654</span></span><span class="hljs-meta"> </span><span style="color: #800080"><span class="hljs-meta">0.00338719</span></span><span class="hljs-meta"> </span><span style="color: #800080"><span class="hljs-meta">0.00385783</span></span><span class="hljs-meta">
 </span><span style="color: #800080"><span class="hljs-meta">0.00432847</span></span><span class="hljs-meta"> </span><span style="color: #800080"><span class="hljs-meta">0.00479474</span></span>]</pre>
</div>
<hr>
<h2>（四）在獲取了背景區域和前景區域（其實前景區域是我們的種子，我們將從這裏進行灌水，向四周漲水，但是這個需要在markers中表示）後，這兩個區域中有未重合部分（註1）怎麽辦？首先確定這些區域（尋找種子）</h2>
<div class="code">
<pre class="hljs">註1：<br>這裏是求取硬幣偏白色，使用THRESH_BINARY，所以我們獲取對象是白色區域，是獲取未重合部分<br>若是我們求取樹葉等偏黑，需要使用THRESH_BINARY_INV，此時我們獲取的對象是黑色區域，就變為了獲取重合部分了</pre>
</div>
<p><img alt="技術分享圖片" src="./OpenCV---分水嶺算法 - IT閱讀_files/20180709135800333334.png"></p>
<h2> 開始獲取未知區域unknown（柵欄會創建在這一區域），為下一步獲取種子做準備</h2>
<div class="code">
<pre class="hljs nginx">    <span class="hljs-attribute">surface_fg</span> =<span style="color: #000000"> np.<strong><span style="color: #ff0000">uint8</span></strong>(sure_fg)  <strong><span style="color: #ff0000"><span class="hljs-comment">#保持色彩空間一致才能進行運算，現在是背景空間為整型空間，前景為浮點型空間，所以進行轉換</span></span></strong>
    unknown </span>=<span style="color: #000000"> cv.<strong><span style="color: #ff0000">subtract</span></strong>(sure_bg,surface_fg)
    cv.imshow(</span><span style="color: #800000"><span class="hljs-string">"</span></span><span style="color: #800000"><span class="hljs-string">unkown</span></span><span style="color: #800000"><span class="hljs-string">"</span></span>,unknown)</pre>
</div>
<div class="code">
<pre class="hljs bash"><span style="color: #000000">使用<span class="hljs-built_in">print</span>查看背景前景色彩空間不同
    <span class="hljs-built_in">print</span>(sure_fg[</span><span style="color: #800080">150</span>][<span style="color: #800080">120</span>:<span style="color: #800080">140</span><span style="color: #000000">])
    <span class="hljs-built_in">print</span>(sure_bg[</span><span style="color: #800080">150</span>][<span style="color: #800080">120</span>:<span style="color: #800080">140</span><span style="color: #000000">])
</span>---------------------------------------<span style="color: #000000">
[</span><span style="color: #800080">0</span>. <span style="color: #800080">0</span>. <span style="color: #800080">0</span>. <span style="color: #800080">0</span>. <span style="color: #800080">0</span>. <span style="color: #800080">0</span>. <span style="color: #800080">0</span>. <span style="color: #800080">0</span>. <span style="color: #800080">0</span>. <span style="color: #800080">0</span>. <span style="color: #800080">0</span>. <span style="color: #800080">0</span>. <span style="color: #800080">0</span>. <span style="color: #800080">0</span>. <span style="color: #800080">0</span>. <span style="color: #800080">0</span>. <span style="color: #800080">0</span>. <span style="color: #800080">0</span>. <span style="color: #800080">0</span>. <span style="color: #800080">0</span><span style="color: #000000">.]
[  </span><span style="color: #800080">0</span>   <span style="color: #800080">0</span>   <span style="color: #800080">0</span>   <span style="color: #800080">0</span>   <span style="color: #800080">0</span>   <span style="color: #800080">0</span> <span style="color: #800080">255</span> <span style="color: #800080">255</span> <span style="color: #800080">255</span> <span style="color: #800080">255</span> <span style="color: #800080">255</span> <span style="color: #800080">255</span> <span style="color: #800080">255</span> <span style="color: #800080">255</span> <span style="color: #800080">255</span> <span style="color: #800080">255</span> <span style="color: #800080">255</span> <span style="color: #800080">255</span>
 <span style="color: #800080">255</span> <span style="color: #800080">255</span>]</pre>
</div>
<p><img alt="技術分享圖片" src="./OpenCV---分水嶺算法 - IT閱讀_files/20180709135800585297.png"></p>
<h2> （五）獲取了這些區域，我們可以獲取種子，這是通過connectedComponents實現,獲取masker標簽，確定的前景區域會在其中顯示為以1開始的數據，這就是我們的種子，會從這裏開始漫水</h2>
<hr>
<h3>推文：http://m.imooc.com/article/32675</h3>
<p><strong>推文：基於矩陣實現的Connected Components算法</strong></p>
<div class="code">
<pre class="hljs">利用connectedComponents求圖中的連通圖</pre>
</div>
<h2><span style="color: #ff0000">重點：</span></h2>
<div class="code">
<pre class="hljs css">現在知道了那些是背景那些是硬幣（確定的前景區域）了。<br>那我們就可以<strong><span style="color: #ff0000">創建標簽（<span style="background-color: #ffff00">一個與原圖像大小相同，數據類型為 <span class="hljs-selector-tag">in32</span> 的數組</span>）</span></strong>，並標記其中的區域了。<br>對我們已經<em><span style="color: #ff0000">確定分類的區域（無論是前景還是背景）使用不同的正整數標記</span></em>，對我們<strong><span style="color: #ff0000">不確定的區域（<span class="hljs-selector-tag">unknown</span>區域）使用 0 標記</span></strong>。<br>我們可以使用函數 <strong><span style="color: #ff0000"><span class="hljs-selector-tag">cv2</span><span class="hljs-selector-class">.connectedComponents</span>()</span></strong>來做這件事。<br>它會把對標簽進行操作，<strong><span style="color: #ff0000">將背景標記為 0，</span><span style="color: #ff0000; background-color: #ffff00">其他的對象使用從 1</span></strong><span style="color: #000000"><span style="background-color: #ffff00"><strong><span style="color: #ff0000"> 開始的正整數標記（其實這就是我們的種子，水漫時會從這裏漫出）</span></strong></span>。然後將這個標簽返回給我們<span class="hljs-selector-tag">markers</span>
但是，我們知道如果<span style="color: #ff0000">背景標記為 </span></span><span style="color: #ff0000">0，那分水嶺算法就會把它當成未知區域</span>了。（<span style="color: #ff0000">我們要將未知區域標記為0，所以我們要將背景區域變為其他整數，例如+1</span>）<br>所以我們想使用不同的整數標記它們。<br>而對不確定的區域（函數<span class="hljs-selector-tag">cv2</span><span class="hljs-selector-class">.connectedComponents</span> 輸出的結果中使用 <span class="hljs-selector-tag">unknown</span> 定義未知區域）標記為 <span style="color: #800080">0</span>。</pre>
</div>
<hr>
<div class="code">
<pre class="hljs shell"><span style="color: #000000"><span class="hljs-meta">#</span><span class="bash">獲取mask</span><br><span class="bash">ret,markers </span></span><span class="bash">=</span><span style="color: #000000"><span class="bash"> cv.connectedComponents(surface_fg)　　</span><br></span></pre>
</div>
<p>函數原型：</p>
<div class="code">
<pre class="hljs python"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">connectedComponents</span><span class="hljs-params">(image, labels=None, connectivity=None, ltype=None)</span>:</span> <span class="hljs-comment"># real signature unknown; restored </span><span style="color: #0000ff"><span class="hljs-comment">from</span></span><span class="hljs-comment"> __doc__</span></pre>
</div>
<h3><span style="color: #ff0000">參數：</span></h3>
<div class="code">
<pre class="hljs">參數image是需要進行連通域處理的二值圖像，其他的這裏用不到</pre>
</div>
<p><strong><span style="color: #ff0000">返回值：</span></strong></p>
<div class="code">
<pre class="hljs"><span style="background-color: #ffff00"><strong><span style="color: #ff0000">ret是連通域處理的邊緣條數，是上面提到的確定區域（出去背景外的其他確定區域：就是前景），就是種子數，我們會從種子開始向外漲水
markers是我們創建的一個標簽（一個與原圖像大小相同，數據類型為 in32 的數組），其中包含有我們原圖像的確認區域的數據（前景區域）</span></strong></span></pre>
</div>
<h3><span style="color: #ff0000">查看部分markers：（0代表的是背景色，）</span></h3>
<div class="code">
<pre class="hljs bash">[<span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0　<span style="color: #ff0000">　<span class="hljs-comment">#0是我們的背景區域</span></span></span>
 <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span>
 <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">2</span> <span style="color: #800080">2　　<span style="color: #ff0000; background-color: #ffff00"><span class="hljs-comment">#像這些以1開始的整數就是我們確定的前景區域，就是我們要找的種子</span></span></span>
 <span style="color: #800080">2</span> <span style="color: #800080">2</span> <span style="color: #800080">2</span> <span style="color: #800080">2</span> <span style="color: #800080">2</span> <span style="color: #800080">2</span> <span style="color: #800080">2</span> <span style="color: #800080">2</span> <span style="color: #800080">2</span> <span style="color: #800080">2</span> <span style="color: #800080">2</span> <span style="color: #800080">2</span> <span style="color: #800080">2</span> <span style="color: #800080">2</span> <span style="color: #800080">2</span> <span style="color: #800080">2</span> <span style="color: #800080">2</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span>
 <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">1</span> <span style="color: #800080">1</span> <span style="color: #800080">1</span> <span style="color: #800080">1</span> <span style="color: #800080">1</span> <span style="color: #800080">1</span> <span style="color: #800080">1</span> <span style="color: #800080">1</span> <span style="color: #800080">1</span> <span style="color: #800080">1</span> <span style="color: #800080">1</span> <span style="color: #800080">1</span> <span style="color: #800080">1</span> <span style="color: #800080">1</span>
 <span style="color: #800080">1</span> <span style="color: #800080">1</span> <span style="color: #800080">1</span> <span style="color: #800080">1</span> <span style="color: #800080">1</span> <span style="color: #800080">1</span> <span style="color: #800080">1</span> <span style="color: #800080">1</span> <span style="color: #800080">1</span> <span style="color: #800080">1</span> <span style="color: #800080">1</span> <span style="color: #800080">1</span> <span style="color: #800080">1</span> <span style="color: #800080">1</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span>
 <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span>
 <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span>
 <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span>
 <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span>
 <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span>
 <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span> <span style="color: #800080">0</span>]</pre>
</div>
<h2>（六）根據未知區域unknown在markers中設置柵欄，並將背景區域加入種子區域，一起漫水</h2>
<h3>註意：</h3>
<div class="code">
<pre class="hljs bash"><span style="color: #000000"><span style="color: #ff0000">watershed漫水算法需要我們將柵欄區域設置為0</span>，所以我們需要將markers中背景區域（原來為0，會幹擾算法）設置為其他整數。
<span style="color: #ff0000">解決方法將markers整體加一</span>　　<span style="background-color: #ffff00"><strong><span style="color: #ff0000"><span class="hljs-comment">#此時種子區域不止我們原來的前景區域，有增加了一個背景區域，我們將從這些區域一起灌水</span></span></strong></span></span></pre>
</div>
<div class="code">
<pre class="hljs nginx"><span style="color: #000000">    <span class="hljs-attribute">markers</span> </span>= markers + <span style="color: #800080"><span class="hljs-number">1</span></span><span style="color: #000000">
    markers[unknown</span>==<span style="color: #800080"><span class="hljs-number">255</span></span>] = <span style="color: #800080"><span class="hljs-number">0</span></span></pre>
</div>
<h2>（七）根據種子開始漫水，讓水漫起來找到最後的漫出點（柵欄邊界），越過這個點後各個山谷中水開始合並。註意watershed會將找到的柵欄在markers中設置為-1</h2>
<div class="code">
<pre class="hljs nginx">    <span class="hljs-attribute">markers</span> = cv.<strong><span style="color: #ff0000">watershed</span></strong>(image,markers=<span style="color: #000000">markers)　　<strong><span style="color: #ff0000"><span class="hljs-comment">#獲取柵欄</span></span></strong>
    image[markers</span>==-<span style="color: #800080"><span class="hljs-number">1</span></span>] = [<span style="color: #800080"><span class="hljs-number">0</span></span>,<span style="color: #800080"><span class="hljs-number">0</span></span>,<span style="color: #800080"><span class="hljs-number">255</span></span>]　　<span class="hljs-comment">#</span><strong><span style="color: #ff0000"><span class="hljs-comment">根據柵欄，我們對原圖像進行操作，對柵欄區域設置為紅色</span></span></strong></pre>
</div>
<h3> markers再次查看</h3>
<div class="code">
<pre class="hljs json">[<span class="hljs-number">-</span><span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>
  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>
  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>
  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>
  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span> <span class="hljs-number">-</span><span style="color: #800080"><span class="hljs-number">1</span></span> <span class="hljs-number">-</span><span style="color: #800080"><span class="hljs-number">1</span></span> <span class="hljs-number">-</span><span style="color: #800080"><span class="hljs-number">1</span></span> <span class="hljs-number">-</span><span style="color: #800080"><span class="hljs-number">1</span></span> <span class="hljs-number">-</span><span style="color: #800080"><span class="hljs-number">1</span></span> <span class="hljs-number">-</span><span style="color: #800080"><span class="hljs-number">1</span></span> <span class="hljs-number">-</span><span style="color: #800080"><span class="hljs-number">1</span>　　<span style="color: #ff0000; background-color: #ffff00">#漫水算法會將找到的柵欄設置為<span class="hljs-number">-1</span></span></span>
 <span class="hljs-number">-</span><span style="color: #800080"><span class="hljs-number">1</span></span> <span class="hljs-number">-</span><span style="color: #800080"><span class="hljs-number">1</span></span> <span class="hljs-number">-</span><span style="color: #800080"><span class="hljs-number">1</span></span> <span class="hljs-number">-</span><span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>
  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span> <span class="hljs-number">-</span><span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">2</span></span>  <span style="color: #800080"><span class="hljs-number">2</span></span>  <span style="color: #800080"><span class="hljs-number">2</span></span>  <span style="color: #800080"><span class="hljs-number">2</span></span>  <span style="color: #800080"><span class="hljs-number">2</span></span>  <span style="color: #800080"><span class="hljs-number">2</span></span>  <span style="color: #800080"><span class="hljs-number">2</span></span>  <span style="color: #800080"><span class="hljs-number">2</span></span>  <span style="color: #800080"><span class="hljs-number">2</span></span>  <span style="color: #800080"><span class="hljs-number">2</span></span>
  <span style="color: #800080"><span class="hljs-number">2</span></span>  <span style="color: #800080"><span class="hljs-number">2</span></span>  <span style="color: #800080"><span class="hljs-number">2</span></span>  <span style="color: #800080"><span class="hljs-number">2</span></span>  <span style="color: #800080"><span class="hljs-number">2</span></span>  <span style="color: #800080"><span class="hljs-number">2</span></span>  <span style="color: #800080"><span class="hljs-number">2</span></span>  <span style="color: #800080"><span class="hljs-number">2</span></span>  <span style="color: #800080"><span class="hljs-number">2</span></span>  <span style="color: #800080"><span class="hljs-number">2</span></span>  <span style="color: #800080"><span class="hljs-number">2</span></span>  <span style="color: #800080"><span class="hljs-number">2</span></span>  <span style="color: #800080"><span class="hljs-number">2</span></span>  <span style="color: #800080"><span class="hljs-number">2</span></span>  <span style="color: #800080"><span class="hljs-number">2</span></span>  <span style="color: #800080"><span class="hljs-number">2</span></span>  <span style="color: #800080"><span class="hljs-number">2</span></span>  <span style="color: #800080"><span class="hljs-number">2</span></span>  <span style="color: #800080"><span class="hljs-number">2</span></span>  <span style="color: #800080"><span class="hljs-number">2</span></span>  <span style="color: #800080"><span class="hljs-number">2</span></span>  <span style="color: #800080"><span class="hljs-number">2</span></span>  <span style="color: #800080"><span class="hljs-number">2</span></span>  <span style="color: #800080"><span class="hljs-number">2</span></span>
  <span style="color: #800080"><span class="hljs-number">2</span></span>  <span style="color: #800080"><span class="hljs-number">2</span></span>  <span style="color: #800080"><span class="hljs-number">2</span></span>  <span style="color: #800080"><span class="hljs-number">2</span></span>  <span style="color: #800080"><span class="hljs-number">2</span></span>  <span style="color: #800080"><span class="hljs-number">2</span></span>  <span style="color: #800080"><span class="hljs-number">2</span></span>  <span style="color: #800080"><span class="hljs-number">2</span></span>  <span style="color: #800080"><span class="hljs-number">2</span></span>  <span style="color: #800080"><span class="hljs-number">2</span></span>  <span style="color: #800080"><span class="hljs-number">2</span></span>  <span style="color: #800080"><span class="hljs-number">2</span></span>  <span style="color: #800080"><span class="hljs-number">2</span></span>  <span style="color: #800080"><span class="hljs-number">2</span></span>  <span style="color: #800080"><span class="hljs-number">2</span></span>  <span style="color: #800080"><span class="hljs-number">2</span></span>  <span style="color: #800080"><span class="hljs-number">2</span></span>  <span style="color: #800080"><span class="hljs-number">2</span></span>  <span style="color: #800080"><span class="hljs-number">2</span></span>  <span style="color: #800080"><span class="hljs-number">2</span></span> <span class="hljs-number">-</span><span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>
  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>
  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>
  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>
  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>
  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>
  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>
  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>
  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>
  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span>  <span style="color: #800080"><span class="hljs-number">1</span></span> <span class="hljs-number">-</span><span style="color: #800080"><span class="hljs-number">1</span></span>]</pre>
</div>
<h2>（八）結果查看</h2>
<p><img alt="技術分享圖片" src="./OpenCV---分水嶺算法 - IT閱讀_files/20180709135800759132.png"></p>
<h2>（九）全部代碼</h2>
<div class="code">
<pre class="hljs python"><span class="hljs-keyword">import</span> cv2 <span style="color: #0000ff"><span class="hljs-keyword">as</span></span><span style="color: #000000"> cv
<span class="hljs-keyword">import</span> numpy </span><span style="color: #0000ff"><span class="hljs-keyword">as</span></span><span style="color: #000000"> np

<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">watershed_demo</span><span class="hljs-params">(image)</span>:</span>
    blur </span>= cv.pyrMeanShiftFiltering(image,<span style="color: #800080"><span class="hljs-number">10</span></span>,<span style="color: #800080"><span class="hljs-number">100</span></span><span style="color: #000000">)
    gray </span>=<span style="color: #000000"> cv.cvtColor(blur,cv.COLOR_BGR2GRAY)  <span class="hljs-comment">#獲取灰度圖像</span>

    ret,binary </span>= cv.threshold(gray,<span style="color: #800080"><span class="hljs-number">0</span></span>,<span style="color: #800080"><span class="hljs-number">255</span></span>,cv.THRESH_BINARY|<span style="color: #000000">cv.THRESH_OTSU)
    <span class="hljs-comment">#形態學操作，進一步消除圖像中噪點</span>
    kernel </span>= cv.getStructuringElement(cv.MORPH_RECT,(<span style="color: #800080"><span class="hljs-number">3</span></span>,<span style="color: #800080"><span class="hljs-number">3</span></span><span style="color: #000000">))
    mb </span>= cv.morphologyEx(binary,cv.MORPH_OPEN,kernel,iterations=<span style="color: #800080"><span class="hljs-number">2</span></span><span style="color: #000000">)  <span class="hljs-comment">#iterations連續兩次開操作</span>
    sure_bg </span>= cv.dilate(mb,kernel,iterations=<span style="color: #800080"><span class="hljs-number">3</span></span><span style="color: #000000">) <span class="hljs-comment">#3次膨脹,可以獲取到大部分都是背景的區域</span>
    cv.imshow(</span><span style="color: #800000"><span class="hljs-string">"</span></span><span style="color: #800000"><span class="hljs-string">sure_bg</span></span><span style="color: #800000"><span class="hljs-string">"</span></span><span style="color: #000000">,sure_bg)
    <span class="hljs-comment">#距離變換</span>
    dist </span>= cv.distanceTransform(mb,cv.DIST_L2,<span style="color: #800080"><span class="hljs-number">5</span></span><span style="color: #000000">)
    cv.imshow(</span><span style="color: #800000"><span class="hljs-string">"</span></span><span style="color: #800000"><span class="hljs-string">dist</span></span><span style="color: #800000"><span class="hljs-string">"</span></span><span style="color: #000000">,dist)
    dist_output </span>= cv.normalize(dist,<span style="color: #800080"><span class="hljs-number">0</span></span>,<span style="color: #800080"><span class="hljs-number">1.0</span></span><span style="color: #000000">,cv.NORM_MINMAX)
    <span class="hljs-comment"># print(mb[</span></span><span style="color: #800080"><span class="hljs-comment">150</span></span><span class="hljs-comment">][</span><span style="color: #800080"><span class="hljs-comment">120</span></span><span class="hljs-comment">:</span><span style="color: #800080"><span class="hljs-comment">140</span></span><span style="color: #000000"><span class="hljs-comment">])</span>
    <span class="hljs-comment"># print(dist[</span></span><span style="color: #800080"><span class="hljs-comment">150</span></span><span class="hljs-comment">][</span><span style="color: #800080"><span class="hljs-comment">120</span></span><span class="hljs-comment">:</span><span style="color: #800080"><span class="hljs-comment">140</span></span><span style="color: #000000"><span class="hljs-comment">])</span>
    <span class="hljs-comment"># print(dist_output[</span></span><span style="color: #800080"><span class="hljs-comment">150</span></span><span class="hljs-comment">][</span><span style="color: #800080"><span class="hljs-comment">120</span></span><span class="hljs-comment">:</span><span style="color: #800080"><span class="hljs-comment">140</span></span><span style="color: #000000"><span class="hljs-comment">])</span>
    cv.imshow(</span><span style="color: #800000"><span class="hljs-string">"</span></span><span style="color: #800000"><span class="hljs-string">distinct-t</span></span><span style="color: #800000"><span class="hljs-string">"</span></span>,dist_output*<span style="color: #800080"><span class="hljs-number">50</span></span><span style="color: #000000">)
    ret, sure_fg </span>= cv.threshold(dist,dist.max()*<span style="color: #800080"><span class="hljs-number">0.6</span></span>,<span style="color: #800080"><span class="hljs-number">255</span></span><span style="color: #000000">,cv.THRESH_BINARY)
    cv.imshow(</span><span style="color: #800000"><span class="hljs-string">"</span></span><span style="color: #800000"><span class="hljs-string">sure_fg</span></span><span style="color: #800000"><span class="hljs-string">"</span></span><span style="color: #000000">,sure_fg)
    <span class="hljs-comment"># print(sure_fg[</span></span><span style="color: #800080"><span class="hljs-comment">150</span></span><span class="hljs-comment">][</span><span style="color: #800080"><span class="hljs-comment">120</span></span><span class="hljs-comment">:</span><span style="color: #800080"><span class="hljs-comment">140</span></span><span style="color: #000000"><span class="hljs-comment">])</span>
    <span class="hljs-comment"># print(sure_bg[</span></span><span style="color: #800080"><span class="hljs-comment">150</span></span><span class="hljs-comment">][</span><span style="color: #800080"><span class="hljs-comment">120</span></span><span class="hljs-comment">:</span><span style="color: #800080"><span class="hljs-comment">140</span></span><span style="color: #000000"><span class="hljs-comment">])</span>
    <span class="hljs-comment">#獲取未知區域</span>
    surface_fg </span>=<span style="color: #000000"> np.uint8(sure_fg)  <span class="hljs-comment">#保持色彩空間一致才能進行運算，現在是背景空間為整型空間，前景為浮點型空間，所以進行轉換</span>
    unknown </span>=<span style="color: #000000"> cv.subtract(sure_bg,surface_fg)
    cv.imshow(</span><span style="color: #800000"><span class="hljs-string">"</span></span><span style="color: #800000"><span class="hljs-string">unkown</span></span><span style="color: #800000"><span class="hljs-string">"</span></span><span style="color: #000000">,unknown)
    <span class="hljs-comment">#獲取maskers,在markers中含有種子區域</span>
    ret,markers </span>=<span style="color: #000000"> cv.connectedComponents(surface_fg)
    <span class="hljs-comment">#print(ret)</span>

    <span class="hljs-comment">#分水嶺變換</span>
    markers </span>= markers + <span style="color: #800080"><span class="hljs-number">1</span></span><span style="color: #000000">
    markers[unknown</span>==<span style="color: #800080"><span class="hljs-number">255</span></span>] = <span style="color: #800080"><span class="hljs-number">0</span></span><span style="color: #000000">

    markers </span>= cv.watershed(image,markers=<span style="color: #000000">markers)
    image[markers</span>==<span class="hljs-number">-</span><span style="color: #800080"><span class="hljs-number">1</span></span>] = [<span style="color: #800080"><span class="hljs-number">0</span></span>,<span style="color: #800080"><span class="hljs-number">0</span></span>,<span style="color: #800080"><span class="hljs-number">255</span></span><span style="color: #000000">]</span><span style="color: #000000">

    cv.imshow(</span><span style="color: #800000"><span class="hljs-string">"</span></span><span style="color: #800000"><span class="hljs-string">result</span></span><span style="color: #800000"><span class="hljs-string">"</span></span><span style="color: #000000">,image)

src </span>= cv.imread(<span style="color: #800000"><span class="hljs-string">"</span></span><span style="color: #800000"><span class="hljs-string">./c.png</span></span><span style="color: #800000"><span class="hljs-string">"</span></span><span style="color: #000000">)  <span class="hljs-comment">#讀取圖片</span>
cv.namedWindow(</span><span style="color: #800000"><span class="hljs-string">"</span></span><span style="color: #800000"><span class="hljs-string">input image</span></span><span style="color: #800000"><span class="hljs-string">"</span></span><span style="color: #000000">,cv.WINDOW_AUTOSIZE)    <span class="hljs-comment">#創建GUI窗口,形式為自適應</span>
cv.imshow(</span><span style="color: #800000"><span class="hljs-string">"</span></span><span style="color: #800000"><span class="hljs-string">input image</span></span><span style="color: #800000"><span class="hljs-string">"</span></span><span style="color: #000000">,src)    <span class="hljs-comment">#通過名字將圖像和窗口聯系</span>

watershed_demo(src)

cv.waitKey(</span><span style="color: #800080"><span class="hljs-number">0</span></span><span style="color: #000000">)   <span class="hljs-comment">#等待用戶操作，裏面等待參數是毫秒，我們填寫0，代表是永遠，等待用戶操作</span>
cv.destroyAllWindows()  <span class="hljs-comment">#銷毀所有窗口</span></span></pre>
</div>
<p> </p><p>OpenCV---分水嶺算法</p>
	 <center><script type="text/javascript" src="./OpenCV---分水嶺算法 - IT閱讀_files/336.js.下載"></script><script type="text/javascript">
    google_ad_client = "ca-pub-0154844852420477";
    google_ad_slot = "8903200626";
    google_ad_width = 336;
    google_ad_height = 280;
</script>
<!-- 336 red -->
<script type="text/javascript" src="./OpenCV---分水嶺算法 - IT閱讀_files/f(9).txt">
</script><ins id="aswift_0_expand" style="display:inline-table;border:none;height:280px;margin:0;padding:0;position:relative;visibility:visible;width:336px;background-color:transparent;" data-ad-slot="8903200626"><ins id="aswift_0_anchor" style="display:block;border:none;height:280px;margin:0;padding:0;position:relative;visibility:visible;width:336px;background-color:transparent;"><iframe width="336" height="280" frameborder="0" marginwidth="0" marginheight="0" vspace="0" hspace="0" allowtransparency="true" scrolling="no" allowfullscreen="true" onload="var i=this.id,s=window.google_iframe_oncopy,H=s&amp;&amp;s.handlers,h=H&amp;&amp;H[i],w=this.contentWindow,d;try{d=w.document}catch(e){}if(h&amp;&amp;d&amp;&amp;(!d.body||!d.body.firstChild)){if(h.call){setTimeout(h,0)}else if(h.match){try{h=s.upd(h,i)}catch(e){}w.location.replace(h)}}" id="aswift_0" name="aswift_0" style="left:0;position:absolute;top:0;border:0px;width:336px;height:280px;" src="./OpenCV---分水嶺算法 - IT閱讀_files/saved_resource(4).html"></iframe></ins></ins>
</center>
          <nav class="pagination group">
                      </nav><!--/.pagination-->
        </div>

    
        <div class="clear"></div>
      </div><!--/.entry-->

    </div><!--/.post-inner-->
  </article><!--/.post-->

<div class="clear"></div>

<p class="post-tags"><span>標籤：</span>  </p>




<h4 class="heading">
	<i class="far fa-hand-point-right"></i>您可能也會喜歡…</h4>

 <ul class="lrelated-posts group">
		 	<li><a href="https://www.itread01.com/content/1531123099.html" target="_blank">OpenCV---分水嶺算法</a> </li>
    	<li><a href="https://www.itread01.com/content/1547219347.html" target="_blank">Opencv 分水嶺演算法用於影象分割</a> </li>
    	<li><a href="https://www.itread01.com/content/1546983201.html" target="_blank">opencv分水嶺演算法分割硬幣</a> </li>
    	<li><a href="https://www.itread01.com/content/1546770263.html" target="_blank">opencv分水嶺分割演算法C++是</a> </li>
    	<li><a href="https://www.itread01.com/content/1546598375.html" target="_blank">Python之opencv 分水嶺分割演算法</a> </li>
    	<li><a href="https://www.itread01.com/content/1546718606.html" target="_blank">Opencv學習——影象分割之分水嶺演算法</a> </li>
    	<li><a href="https://www.itread01.com/content/1546610950.html" target="_blank">分水嶺演算法（Watershed algorithm）與OpenCV實現</a> </li>
    	<li><a href="https://www.itread01.com/content/1546418545.html" target="_blank">OpenCV庫中watershed函式（分水嶺演算法）的詳細使用例程</a> </li>
    	<li><a href="https://www.itread01.com/content/1546380923.html" target="_blank">【opencv學習之三十八】影象的分水嶺演算法</a> </li>
    	<li><a href="https://www.itread01.com/content/1546107506.html" target="_blank">python opencv入門 分水嶺演算法（29）</a> </li>
    	<li><a href="https://www.itread01.com/content/1544946517.html" target="_blank">Opencv影象處理---基於距離變換和分水嶺演算法的影象分割</a> </li>
    	<li><a href="https://www.itread01.com/content/1544729802.html" target="_blank">OpenCV學習三十四：watershed 分水嶺演算法</a> </li>
    	<li><a href="https://www.itread01.com/content/1544508395.html" target="_blank">opencv學習筆記五十六：分水嶺分割演算法</a> </li>
    	<li><a href="https://www.itread01.com/content/1547132224.html" target="_blank">基於標記符的分水嶺分割演算法</a> </li>
    	<li><a href="https://www.itread01.com/content/1547055201.html" target="_blank">matlab之watershed分水嶺分割演算法</a> </li>
     
</ul><!--/.post-related-->



        </div><!--/.pad-->
        </section><!--/.content-->
          

	<div class="sidebar s1 collapsed" data-position="right" data-layout="col-2cl" data-sb-id="s1" style="transform: translateZ(0px);">

		<a class="sidebar-toggle" title="延伸側邊欄位" style="transform: translate(0px, 0px);"><i class="fas icon-sidebar-toggle"></i></a>

		<div class="sidebar-content" style="transform: translate(0px, 0px);">

			  			<div class="sidebar-top group">
                        <p>贊助商廣告</p>
             
           			</div>
			<script type="text/javascript" src="./OpenCV---分水嶺算法 - IT閱讀_files/auto.js.下載"></script> <script async="" src="./OpenCV---分水嶺算法 - IT閱讀_files/f(8).txt"></script>
<ins class="adsbygoogle" style="display: block; height: 280px;" data-ad-client="ca-pub-0154844852420477" data-ad-slot="2357692629" data-ad-format="auto" data-adsbygoogle-status="done"><ins id="aswift_2_expand" style="display:inline-table;border:none;height:280px;margin:0;padding:0;position:relative;visibility:visible;width:340px;background-color:transparent;"><ins id="aswift_2_anchor" style="display:block;border:none;height:280px;margin:0;padding:0;position:relative;visibility:visible;width:340px;background-color:transparent;"><iframe width="340" height="280" frameborder="0" marginwidth="0" marginheight="0" vspace="0" hspace="0" allowtransparency="true" scrolling="no" allowfullscreen="true" onload="var i=this.id,s=window.google_iframe_oncopy,H=s&amp;&amp;s.handlers,h=H&amp;&amp;H[i],w=this.contentWindow,d;try{d=w.document}catch(e){}if(h&amp;&amp;d&amp;&amp;(!d.body||!d.body.firstChild)){if(h.call){setTimeout(h,0)}else if(h.match){try{h=s.upd(h,i)}catch(e){}w.location.replace(h)}}" id="aswift_2" name="aswift_2" style="left:0;position:absolute;top:0;border:0px;width:340px;height:280px;" src="./OpenCV---分水嶺算法 - IT閱讀_files/saved_resource(5).html"></iframe></ins></ins></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>

				<ul class="post-nav group">
      
 
		<li class="previous"> </li>
  
  
		 <li class="next">  </li>
 
	</ul>

<div id="custom_html-3" class="widget_text widget widget_custom_html"><div class="textwidget custom-html-widget"><!-- /109765683/300x250 -->
<div id="div-gpt-ad-1533118487383-0">
<script>
googletag.cmd.push(function() { googletag.display('div-gpt-ad-1533118487383-0'); });
</script>
</div>
</div></div><div id="text-7" class="widget widget_text">			 
		</div>
        
        <div id="alxtabs-2" class="widget widget_hu_tabs">
<h3 class="widget-title"></h3>
<ul class="alx-tabs-nav group tab-count-3"><li class="alx-tab tab-recent active"><a href="https://www.itread01.com/content/1531123099.html#tab-recent-2" title="熱門文章"><i class="far fa-clock"></i></a></li><li class="alx-tab tab-tags"><a href="https://www.itread01.com/content/1531123099.html#tab-tags-2" title="標籤"><i class="fas fa-star"></i> </a></li></ul>
	<div class="alx-tabs-container">						
			<ul id="tab-recent-2" class="alx-tab group" style="display: block;">
								 
					      
                  <li>
					<div class="tab-item-inner group">
						 						
                        <p class="tab-item-title"> <a href="https://www.itread01.com/content/1531123102.html">生成器和可叠代對象和叠代器 </a></p>
										</div>
				</li>
                
                
                 <li>
					<div class="tab-item-inner group">
						 						
                        <p class="tab-item-title"> <a href="https://www.itread01.com/content/1531123105.html">系統集成項目管理工程師教程 第二版下載,僅供學習交流使用 </a></p>
										</div>
				</li>
                
                
                 <li>
					<div class="tab-item-inner group">
						 						
                        <p class="tab-item-title"> <a href="https://www.itread01.com/content/1531123322.html">自從會了Python之後，我就沒用過PS了！帶你將照片變成卡通圖片！ </a></p>
										</div>
				</li>
                
                
                 <li>
					<div class="tab-item-inner group">
						 						
                        <p class="tab-item-title"> <a href="https://www.itread01.com/content/1531123324.html">Java後臺Excel表導出 </a></p>
										</div>
				</li>
                
                
                 <li>
					<div class="tab-item-inner group">
						 						
                        <p class="tab-item-title"> <a href="https://www.itread01.com/content/1531123326.html">C# 讀Autofac源碼筆記（1） </a></p>
										</div>
				</li>
                
                
                 <li>
					<div class="tab-item-inner group">
						 						
                        <p class="tab-item-title"> <a href="https://www.itread01.com/content/1531123329.html">劍指Offer--第16題 數值的整數次方 </a></p>
										</div>
				</li>
                
                
                 <li>
					<div class="tab-item-inner group">
						 						
                        <p class="tab-item-title"> <a href="https://www.itread01.com/content/1531123331.html">python ConfigParser讀取配置文件，及解決報錯ConfigParser.MissingSectionHeaderError: File contains no section headers的方法 </a></p>
										</div>
				</li>
                
                
                 <li>
					<div class="tab-item-inner group">
						 						
                        <p class="tab-item-title"> <a href="https://www.itread01.com/content/1531123336.html">命令行創建sftp用戶 </a></p>
										</div>
				</li>
                
                
                 <li>
					<div class="tab-item-inner group">
						 						
                        <p class="tab-item-title"> <a href="https://www.itread01.com/content/1531123341.html">Java-性能調優-理解GC日誌 </a></p>
										</div>
				</li>
                
                
                 <li>
					<div class="tab-item-inner group">
						 						
                        <p class="tab-item-title"> <a href="https://www.itread01.com/content/1531123344.html">爬取汽車之家 </a></p>
										</div>
				</li>
                
                
  	 
				</ul><!--/.alx-tab-->

			<ul id="tab-tags-2" class="alx-tab group" style="display: none;">
				<li>
					<a href="https://www.itread01.com/android/" class="tag-cloud-link tag-link-9 tag-link-position-1" style="font-size: 12.15625pt;">Android</a> 	
					<a href="https://www.itread01.com/php/" class="tag-cloud-link tag-link-9 tag-link-position-1" style="font-size: 12.15625pt;">PHP</a> 
					<a href="https://www.itread01.com/mysql/" class="tag-cloud-link tag-link-9 tag-link-position-1" style="font-size: 12.15625pt;">Mysql</a> 
					<a href="https://www.itread01.com/windows/" class="tag-cloud-link tag-link-9 tag-link-position-1" style="font-size: 12.15625pt;">Windows</a> 
					<a href="https://www.itread01.com/ios/" class="tag-cloud-link tag-link-9 tag-link-position-1" style="font-size: 12.15625pt;">IOS</a> 
					<a href="https://www.itread01.com/%E7%A8%8B%E5%BC%8F/" class="tag-cloud-link tag-link-9 tag-link-position-1" style="font-size: 12.15625pt;">程式</a> 
                    <a href="https://www.codetw.com/list/" class="tag-cloud-link tag-link-9 tag-link-position-1" style="font-size: 12.15625pt;">程式問答</a></li>
			</ul><!--/.alx-tab-->

			</div>
</div>
		</div><!--/.sidebar-content-->

	</div><!--/.sidebar-->

	

        </div><!--/.main-inner-->
      </div><!--/.main-->
    </div><!--/.container-inner-->
  </div><!--/.container-->
    <footer id="footer">
          <nav class="nav-container group" id="nav-footer" data-menu-id="footer-4" data-menu-scrollable="false">
                      <!-- <div class="ham__navbar-toggler collapsed" aria-expanded="false">
          <div class="ham__navbar-span-wrapper">
            <span class="ham-toggler-menu__span"></span>
          </div>
        </div> -->
        <div class="ham__navbar-toggler-two collapsed" title="Menu" aria-expanded="false">
          <div class="ham__navbar-span-wrapper">
            <span class="line line-1"></span>
            <span class="line line-2"></span>
            <span class="line line-3"></span>
          </div>
        </div>
                    <div class="nav-text"></div>
        <div class="nav-wrap">
          <ul id="menu-top-2" class="nav container group">
           <li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-290"><a href="https://www.itread01.com/" rel="nofollow">首頁</a></li>
 
</ul>        </div>
      </nav><!--/#nav-footer-->
    
    <section class="container" id="footer-bottom">
      <div class="container-inner">

        <a id="back-to-top" href="https://www.itread01.com/content/1531123099.html#"><i class="fas fa-angle-up"></i></a>

        <div class="pad group">

          <div class="grid one-half">
                        
            <div id="copyright">
                              <p>ITREAD01.COM © 2018. 版權所有。 </p>
                          </div><!--/#copyright-->
          </div>
        </div><!--/.pad-->

      </div><!--/.container-inner-->
    </section><!--/.container-->

  </footer><!--/#footer-->

</div><!--/#wrapper-->

<!-- Powered by WPtouch: 4.3.27 --><script type="text/javascript" src="./OpenCV---分水嶺算法 - IT閱讀_files/jQuerySharrre.min.js.下載"></script>
<script type="text/javascript" src="./OpenCV---分水嶺算法 - IT閱讀_files/underscore.min.js.下載"></script>
<script type="text/javascript">
/* <![CDATA[ */
var HUParams = {"_disabled":[],"SmoothScroll":{"Enabled":true,"Options":{"touchpadSupport":false}},"centerAllImg":"1","timerOnScrollAllBrowsers":"1","extLinksStyle":"1","extLinksTargetExt":"1","extLinksSkipSelectors":{"classes":["btn","button"],"ids":[]},"imgSmartLoadEnabled":"","imgSmartLoadOpts":{"parentSelectors":[".container .content",".container .sidebar","#footer","#header-widgets"],"opts":{"excludeImg":[".tc-holder-img"],"fadeIn_options":100}},"goldenRatio":"1.618","gridGoldenRatioLimit":"350","sbStickyUserSettings":{"desktop":true,"mobile":false},"isWPMobile":"","menuStickyUserSettings":{"desktop":"stick_up","mobile":"stick_up"},"isDevMode":"","ajaxUrl":"https:\/\/www.itread01.com\/?huajax=1","frontNonce":{"id":"HuFrontNonce","handle":"d9125fec3b"},"userStarted":{"with":"with|3.3.27","on":{"date":"2018-03-27 03:41:18.000000","timezone_type":3,"timezone":"UTC"}},"isWelcomeNoteOn":"","welcomeContent":""};
/* ]]> */
</script>
<script type="text/javascript" src="./OpenCV---分水嶺算法 - IT閱讀_files/scripts.min.js.下載"></script>
<script type="text/javascript" src="./OpenCV---分水嶺算法 - IT閱讀_files/wp-embed.min.js.下載"></script><iframe id="google_osd_static_frame_4082401835294" name="google_osd_static_frame" style="display: none; width: 0px; height: 0px;" src="./OpenCV---分水嶺算法 - IT閱讀_files/saved_resource(6).html"></iframe>
<script type="text/javascript" src="./OpenCV---分水嶺算法 - IT閱讀_files/c.js.下載"></script><script src="./OpenCV---分水嶺算法 - IT閱讀_files/z_stat.php" language="JavaScript"></script><script src="./OpenCV---分水嶺算法 - IT閱讀_files/core.php" charset="utf-8" type="text/javascript"></script><a href="https://www.cnzz.com/stat/website.php?web_id=1275098034" target="_blank" title="站长统计">站长统计</a>

<!--[if lt IE 9]>
<script src="/img/css/js/respond.js"></script>
<![endif]-->
<div style="display:none">0.055531024932861</div>

    <!-- Bootstrap core JavaScript ================================================== -->
        <script src="./OpenCV---分水嶺算法 - IT閱讀_files/jquery.min.js.下載"></script>
     
        <!-- Placed at the end of the document so the pages load faster -->
        

<script src="./OpenCV---分水嶺算法 - IT閱讀_files/highlight.min.js.下載"></script>
<script>
function joinUrl(url, concat) {
  var url1 = url.split('/');
  var url2 = concat.split('/');
  var url3 = [ ];
  for (var i = 0, l = url1.length; i < l; i ++) {
    if (url1[i] == '..') {
      url3.pop();
    } else if (url1[i] == '.') {
      continue;
    } else {
      url3.push(url1[i]);
    }
  }
  for (var i = 0, l = url2.length; i < l; i ++) {
    if (url2[i] == '..') {
      url3.pop();
    } else if (url2[i] == '.') {
      continue;
    } else {
      url3.push(url2[i]);
    }
  }
  return url3.join('/');
}
$(document).ready(function() {
    $('pre').each(function(i, block) {
        hljs.highlightBlock(block);
    });
	var source = $('#source-url').html();
	if(source.indexOf('segmentfault.com') > 0) {
		var imgs = $('#main-content').find('img');
		$.each(imgs, function(index, img) {
			var data_src = $(img).attr('data-src');
			data_src = 'https://segmentfault.com' + data_src;
			console.log(data_src);
			$(img).attr('src', data_src);
			// $(img).attr('src', '');
		});
	}
});
</script><ins class="adsbygoogle adsbygoogle-noablate" data-adsbygoogle-status="done" style="display: none !important;"><ins id="aswift_3_expand" style="display:inline-table;border:none;height:0px;margin:0;padding:0;position:relative;visibility:visible;width:0px;background-color:transparent;"><ins id="aswift_3_anchor" style="display:block;border:none;height:0px;margin:0;padding:0;position:relative;visibility:visible;width:0px;background-color:transparent;"><iframe frameborder="0" marginwidth="0" marginheight="0" vspace="0" hspace="0" allowtransparency="true" scrolling="no" allowfullscreen="true" onload="var i=this.id,s=window.google_iframe_oncopy,H=s&amp;&amp;s.handlers,h=H&amp;&amp;H[i],w=this.contentWindow,d;try{d=w.document}catch(e){}if(h&amp;&amp;d&amp;&amp;(!d.body||!d.body.firstChild)){if(h.call){setTimeout(h,0)}else if(h.match){try{h=s.upd(h,i)}catch(e){}w.location.replace(h)}}" id="aswift_3" name="aswift_3" style="left:0;position:absolute;top:0;border:0px;width:0px;height:0px;" src="./OpenCV---分水嶺算法 - IT閱讀_files/saved_resource(7).html"></iframe></ins></ins></ins></body><iframe id="google_shimpl" style="display: none;" src="./OpenCV---分水嶺算法 - IT閱讀_files/saved_resource(8).html"></iframe><iframe id="google_esf" name="google_esf" src="./OpenCV---分水嶺算法 - IT閱讀_files/zrt_lookup.html" data-ad-client="ca-pub-0154844852420477" style="display: none;"></iframe></html>